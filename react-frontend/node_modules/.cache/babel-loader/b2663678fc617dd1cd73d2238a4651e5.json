{"ast":null,"code":"var _jsxFileName = \"/home/menekou/projects/react/shortest-path/react-frontend/src/Account/Account.js\";\nimport React, { useEffect, useContext, useState } from 'react';\nimport './Account.css';\nimport UserContext from \"../UserContext\";\nimport { useQuery } from '@apollo/client';\nimport MapHelper from '../Helpers/MapHelper';\nimport InputValidationHelper from '../Helpers/InputValidationHelper';\nimport { Link } from 'react-router-dom';\nimport Modal from 'react-bootstrap/Modal';\nimport { useMutation } from '@apollo/client';\n\nfunction EditMapModal({\n  mapName,\n  handleNameEdit,\n  ...props\n}) {\n  let mapNameInvalid = false;\n  let errorMessage = \"\";\n\n  const handleChange = e => {\n    mapNameInvalid = InputValidationHelper.validateString(e.target.value);\n    console.log(mapNameInvalid);\n    errorMessage = \"Invalid map name\";\n  };\n\n  return /*#__PURE__*/React.createElement(Modal, Object.assign({}, props, {\n    size: \"lg\",\n    \"aria-labelledby\": \"contained-modal-title-vcenter\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    id: \"contained-modal-title-vcenter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 15\n    }\n  }, \"Set Map Name\")), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    className: \"editmap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"mapname\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 23\n    }\n  }, \"Map Name\"), mapNameInvalid && errorMessage, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: e => handleChange(e),\n    className: (mapNameInvalid ? \"error\" : \"\") + \"form-control\",\n    id: \"mapname\",\n    \"aria-describedby\": \"mapNameHelp\",\n    type: \"text\",\n    defaultValue: mapName,\n    placeholder: \"Unamed\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 23\n    }\n  })))), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    disabled: mapNameInvalid,\n    onClick: () => handleNameEdit(document.getElementsByClassName(\"editmap\")[0][0].value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 15\n    }\n  }, \"Save Name\")));\n}\n\nfunction EditMapName({\n  map,\n  user,\n  refetch,\n  ...props\n}) {\n  const [modalShow, setModalShow] = React.useState(false);\n  const [editMap, {\n    error: editMapError,\n    loading,\n    data: editMapData\n  }] = useMutation(MapHelper.editMap);\n  useEffect(() => {\n    if (editMapError) {\n      console.log(editMapError);\n    }\n\n    if (editMapData) {\n      console.log(editMapData);\n      refetch();\n    }\n  }, [editMapError, editMapData, refetch]);\n\n  const handleShow = () => {\n    setModalShow(true);\n  };\n\n  const handleClose = () => {\n    setModalShow(false);\n  };\n\n  const handleNameEdit = mapName => {\n    handleClose();\n    console.log(user.username, map.name, mapName, map);\n    editMap({\n      variables: {\n        username: user.username,\n        mapNameOrig: map.name,\n        mapNameEdit: mapName,\n        map: map.map\n      }\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, loading && /*#__PURE__*/React.createElement(\"button\", {\n    disabled: true,\n    onClick: () => handleShow(),\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  }, \"Saving...\"), !loading && /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => handleShow(),\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  }, \"Edit Name\"), /*#__PURE__*/React.createElement(EditMapModal, {\n    show: modalShow,\n    handleNameEdit: mapName => handleNameEdit(mapName),\n    mapName: map.name,\n    onHide: () => handleClose(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 11\n    }\n  }));\n}\n\nfunction Account() {\n  const {\n    user\n  } = useContext(UserContext);\n  const {\n    error: mapsError,\n    data: mapsData,\n    refetch\n  } = useQuery(MapHelper.getUsersMaps, {\n    variables: {\n      username: user.username\n    },\n    notifyOnNetworkStatusChange: true\n  }); //{ fetchPolicy: \"network-only\" }\n\n  const [deleteMap, {\n    error: deleteMapError,\n    loading: deleteMapLoading,\n    data: deleteMapData\n  }] = useMutation(MapHelper.deleteMap);\n  const [maps, setMaps] = useState();\n  useEffect(() => {\n    if (mapsError) {\n      console.log(mapsError);\n    }\n\n    if (mapsData) {\n      console.log(mapsData.getUsersMaps);\n      setMaps(maps => {\n        return mapsData.getUsersMaps;\n      });\n    }\n  }, [user, mapsError, mapsData]);\n  useEffect(() => {\n    if (deleteMapError) {\n      console.log(deleteMapError);\n    }\n\n    if (deleteMapData) {\n      console.log(deleteMapData);\n      refetch();\n    }\n  }, [deleteMapError, deleteMapData, refetch]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"account\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 5\n    }\n  }, user && /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 9\n    }\n  }, user.username), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"links-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }\n  }, maps && maps.map((map, index) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"link-container\",\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"map-info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: {\n        pathname: \"/sandbox\",\n        state: {\n          userMap: map.map,\n          mapName: map.name\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 25\n      }\n    }, map.name)))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"top-users\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 19\n      }\n    }, \"Top 3 Users\"), /*#__PURE__*/React.createElement(\"ol\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 19\n      }\n    }, map.highest_score && /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 23\n      }\n    }, map.highest_score), map.second_highest_score && /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 23\n      }\n    }, map.second_highest_score), map.third_highest_score && /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 23\n      }\n    }, map.third_highest_score))), user.username === map.owner && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"map-edit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 19\n      }\n    }, user && /*#__PURE__*/React.createElement(EditMapName, {\n      user: user,\n      map: map,\n      refetch: refetch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(Link, {\n      to: {\n        pathname: \"/sandbox\",\n        state: {\n          userMap: map.map,\n          mapName: map.name\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 23\n      }\n    }, \"Edit Map\")), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-danger\",\n      onClick: () => {\n        deleteMap({\n          variables: {\n            username: user.username,\n            mapName: map.name\n          }\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 23\n      }\n    }, \"Delete Map\")));\n  })));\n}\n\nexport default Account;","map":{"version":3,"sources":["/home/menekou/projects/react/shortest-path/react-frontend/src/Account/Account.js"],"names":["React","useEffect","useContext","useState","UserContext","useQuery","MapHelper","InputValidationHelper","Link","Modal","useMutation","EditMapModal","mapName","handleNameEdit","props","mapNameInvalid","errorMessage","handleChange","e","validateString","target","value","console","log","document","getElementsByClassName","EditMapName","map","user","refetch","modalShow","setModalShow","editMap","error","editMapError","loading","data","editMapData","handleShow","handleClose","username","name","variables","mapNameOrig","mapNameEdit","Account","mapsError","mapsData","getUsersMaps","notifyOnNetworkStatusChange","deleteMap","deleteMapError","deleteMapLoading","deleteMapData","maps","setMaps","index","pathname","state","userMap","highest_score","second_highest_score","third_highest_score","owner"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState } from 'react';\nimport './Account.css';\nimport UserContext from \"../UserContext\";\nimport { useQuery } from '@apollo/client';\nimport MapHelper from '../Helpers/MapHelper';\nimport InputValidationHelper from '../Helpers/InputValidationHelper';\nimport { Link } from 'react-router-dom';\nimport Modal from 'react-bootstrap/Modal';\nimport { useMutation } from '@apollo/client';\n\nfunction EditMapModal({mapName, handleNameEdit, ...props}){\n  \n  let mapNameInvalid = false;\n  let errorMessage = \"\";\n\n  const handleChange = (e) => {\n    mapNameInvalid = InputValidationHelper.validateString(e.target.value);\n    console.log(mapNameInvalid)\n    errorMessage = \"Invalid map name\"\n  }\n\n  return (\n      <Modal\n          {...props}\n          size=\"lg\"\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n      >\n          <Modal.Header closeButton>\n              <Modal.Title id=\"contained-modal-title-vcenter\">\n                  Set Map Name\n              </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n              <form className=\"editmap\">\n                  <div className=\"form-group\">\n                      <label htmlFor=\"mapname\">Map Name</label>\n                      {mapNameInvalid &&\n                        errorMessage\n                      }\n                      <input onChange={(e) => handleChange(e)} className={(mapNameInvalid ? \"error\" : \"\") + \"form-control\"} id=\"mapname\" aria-describedby=\"mapNameHelp\" type=\"text\" defaultValue={ mapName } placeholder=\"Unamed\"/>\n                  </div>\n              </form>\n          </Modal.Body>\n          <Modal.Footer>\n              <button disabled={mapNameInvalid} onClick={() => handleNameEdit(document.getElementsByClassName(\"editmap\")[0][0].value)}>Save Name</button>\n          </Modal.Footer>\n      </Modal>\n  );\n}\n\nfunction  EditMapName({map, user, refetch, ...props}){\n  const [modalShow, setModalShow] = React.useState(false);\n  const [editMap, { error: editMapError, loading, data: editMapData }] = useMutation(MapHelper.editMap);\n   \n  useEffect(() => {\n    if(editMapError){\n      console.log(editMapError);\n    }\n    \n    if(editMapData){\n      console.log(editMapData);\n      refetch();\n    }\n  }, [editMapError, editMapData, refetch])\n\n  const handleShow = () => {\n      setModalShow(true);\n  }\n\n  const handleClose = () => {\n      setModalShow(false);\n  }\n\n  const handleNameEdit = (mapName) => {\n    handleClose();\n    \n    console.log(user.username, map.name, mapName, map)\n    editMap({\n      variables: {\n        username: user.username,\n        mapNameOrig: map.name,\n        mapNameEdit: mapName,\n        map: map.map\n      }\n    })\n  }\n\n  return (\n      <>\n          { loading &&\n            <button disabled={true} onClick={() => handleShow()} className=\"btn btn-primary\">Saving...</button>\n          }\n\n          { !loading &&\n            <button onClick={() => handleShow()} className=\"btn btn-primary\">Edit Name</button>\n          }        \n\n          <EditMapModal\n              show={modalShow}\n              handleNameEdit={(mapName) => handleNameEdit(mapName)}\n              mapName={map.name}\n              onHide={() => handleClose()}\n          />\n      </>\n  );\n}\n\nfunction Account() {\n  const {user} = useContext(UserContext);\n  const { error: mapsError, data: mapsData, refetch} = useQuery(MapHelper.getUsersMaps, {\n    variables: {\n      username: user.username\n    },\n    notifyOnNetworkStatusChange: true,\n  }); //{ fetchPolicy: \"network-only\" }\n  const [deleteMap, { error: deleteMapError, loading: deleteMapLoading, data: deleteMapData }] = useMutation(MapHelper.deleteMap);\n\n  const [maps, setMaps] = useState(); \n\n  useEffect(() => {\n    if(mapsError){\n      console.log(mapsError);\n    }\n\n    if(mapsData){\n      console.log(mapsData.getUsersMaps);\n\n      setMaps((maps) => {\n        return mapsData.getUsersMaps;\n      })\n    }\n  }, [user, mapsError, mapsData]);\n\n  useEffect(() => {\n    if(deleteMapError){\n      console.log(deleteMapError);\n    }\n\n    if(deleteMapData){\n      console.log(deleteMapData);\n\n\n      refetch();\n    }\n  }, [deleteMapError, deleteMapData, refetch]);\n\n  return (\n    <div id=\"account\">\n      {user &&\n        <h1 className=\"username\">{user.username}</h1>\n      }\n      <div className=\"links-container\">\n      {maps && \n        maps.map((map, index) => {\n          return (\n              <div className=\"link-container\" key={index}>\n                {/* <div className=\"map-preview\">\n                  Map Preview\n                </div> */}\n                <div className=\"map-info\">\n                  <Link to={{pathname: \"/sandbox\", state: { userMap: map.map, mapName: map.name }}}>\n                    <div>\n                        <h3>{map.name}</h3>\n                    </div>\n                  </Link>\n                </div>\n                <div className=\"top-users\">\n                  <div className=\"title\">\n                    Top 3 Users\n                  </div>\n                  <ol>\n                    {map.highest_score &&\n                      <li>\n                        {map.highest_score}\n                      </li>\n                    }\n                    {map.second_highest_score &&\n                      <li>\n                        {map.second_highest_score}\n                      </li>\n                    }\n                    {map.third_highest_score &&\n                      <li>\n                        {map.third_highest_score}\n                      </li>\n                    }\n                  </ol>\n                </div>\n                { user.username === map.owner &&\n                  <div className=\"map-edit\">\n                    { user &&\n                      <EditMapName \n                        user={user}\n                        map={map}\n                        refetch={refetch}\n                      />\n                    }\n                    <Link to={{pathname: \"/sandbox\", state: { userMap: map.map, mapName: map.name }}}>\n                      <button className=\"btn btn-primary\">\n                        Edit Map\n                      </button>\n                    </Link>\n\n                      <button className=\"btn btn-danger\" onClick={() => {\n                        deleteMap({\n                          variables: {\n                            username: user.username,\n                            mapName: map.name\n                          }\n                        })\n                      }}>Delete Map</button>\n\n\n                    {/* {deleteMapLoading &&\n                      <button disabled={true} className=\"btn btn-danger\">Deleting Map...</button>\n                    } */}\n                  </div>\n                }\n              </div>            \n            )\n          })\n        }\n      </div>\n    </div>\n  );\n}\n\nexport default Account;"]},"metadata":{},"sourceType":"module"}
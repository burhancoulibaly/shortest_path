{"ast":null,"code":"var _jsxFileName = \"/home/menekou/projects/react/shortest-path/react-frontend/src/Sandbox/Sandbox.js\";\nimport React, { useState, useEffect, useMemo, useReducer } from 'react';\nimport './Sandbox.css';\nimport Map from '../Map/Map';\nimport Menu from '../Menu/Menu';\nimport MenuContext from '../MenuContext';\nimport { useLazyQuery } from '@apollo/client';\nimport MapHelper from '../Helpers/MapHelper';\n\nfunction init(initialState) {\n  return {\n    itemState: initialState.itemState,\n    clear: initialState.clear,\n    run: initialState.run,\n    heuristic: initialState.heuristic,\n    algorithm: initialState.algorithm,\n    pathClear: initialState.pathClear,\n    cutCorners: initialState.cutCorners,\n    allowDiags: initialState.allowDiags,\n    biDirectional: initialState.biDirectional,\n    isResetting: initialState.isResetting,\n    isSaving: initialState.isSaving,\n    mapName: initialState.mapName,\n    isEdit: initialState.isEdit\n  };\n}\n\nfunction reducer(menuState, action) {\n  switch (action.type) {\n    case 'setItemState':\n      return { ...menuState,\n        itemState: action.payload.itemState\n      };\n\n    case 'mapName':\n      return { ...menuState,\n        mapName: [...menuState.mapName, action.payload.mapName]\n      };\n\n    case 'mapNameReset':\n      return { ...menuState,\n        mapName: []\n      };\n\n    case 'setHeuristic':\n      return { ...menuState,\n        heuristic: action.payload.heuristic\n      };\n\n    case 'setAlgorithm':\n      return { ...menuState,\n        algorithm: action.payload.algorithm\n      };\n\n    case 'clear':\n      return { ...menuState,\n        clear: true\n      };\n\n    case 'cleared':\n      return { ...menuState,\n        clear: false\n      };\n\n    case 'pathClear':\n      return { ...menuState,\n        pathClear: true\n      };\n\n    case 'pathCleared':\n      return { ...menuState,\n        pathClear: false\n      };\n\n    case 'run':\n      return { ...menuState,\n        run: true\n      };\n\n    case 'complete':\n      return { ...menuState,\n        run: false\n      };\n\n    case 'cutCorners':\n      return { ...menuState,\n        cutCorners: !menuState.cutCorners\n      };\n\n    case 'allowDiags':\n      return { ...menuState,\n        allowDiags: !menuState.allowDiags\n      };\n\n    case 'biDirectional':\n      return { ...menuState,\n        biDirectional: !menuState.biDirectional\n      };\n\n    case 'reset':\n      return { ...menuState,\n        isResetting: !menuState.isResetting\n      };\n\n    case 'save':\n      return { ...menuState,\n        isSaving: !menuState.isSaving\n      };\n\n    case 'edit':\n      return { ...menuState,\n        isEdit: true\n      };\n\n    case 'initialize':\n      return init(action.payload.init);\n\n    default:\n      throw new Error(\"Not a valid action\");\n  }\n}\n\nfunction Sandbox(props) {\n  const [winDimensions, setWinDimensions] = useState({\n    width: document.documentElement.clientWidth,\n    height: document.documentElement.clientHeight\n  });\n  const initialState = {\n    itemState: \"start\",\n    heuristic: \"euclidean\",\n    algorithm: \"astar\",\n    clear: false,\n    pathClear: false,\n    run: false,\n    cutCorners: false,\n    allowDiags: true,\n    biDirectional: false,\n    isResetting: false,\n    isSaving: false,\n    mapName: [],\n    isEdit: false\n  };\n  const [menuState, dispatch] = useReducer(reducer, initialState, init);\n  const [localStorageState, setLocalStorageState] = useState({\n    mapName: null,\n    userMap: null,\n    mapVersion: null\n  });\n  const menu = useMemo(() => ({\n    menuState,\n    dispatch\n  }), [menuState, dispatch]);\n  const memlocalStorageState = useMemo(() => ({\n    localStorageState,\n    setLocalStorageState\n  }), [localStorageState, setLocalStorageState]);\n  const [getUserMap, {\n    error: getUserMapError,\n    loading: getUserMapLoading,\n    data: getUserMapData\n  }] = useLazyQuery(MapHelper.getUserMap, {\n    fetchPolicy: \"network-only\"\n  });\n  useEffect(() => {\n    if (getUserMapError) {\n      console.log(getUserMapError);\n    }\n\n    if (getUserMapLoading) {\n      console.log(getUserMapLoading);\n      menu.dispatch({\n        type: \"mapName\",\n        payload: {\n          mapName: \"...\"\n        }\n      });\n    }\n\n    if (getUserMapData) {\n      console.log(\"data retrieved\");\n      menu.dispatch({\n        type: \"edit\"\n      });\n      menu.dispatch({\n        type: \"mapNameReset\"\n      });\n      menu.dispatch({\n        type: \"mapName\",\n        payload: {\n          mapName: getUserMapData.getUserMap.name\n        }\n      });\n      setLocalStorageState(localStorageState => {\n        localStorage.setItem(\"mapVersion\", 0);\n        return { ...memlocalStorageState.localStorageState,\n          mapName: getUserMapData.getUserMap.name,\n          userMap: getUserMapData.getUserMap.map,\n          mapVersion: 0\n        };\n      });\n    }\n  }, [getUserMapError, getUserMapLoading, getUserMapData, menu]);\n\n  const getMap = () => {\n    console.log(getUserMapLoading);\n\n    if (props.location.state) {\n      return props.location.state.userMap;\n    }\n\n    if (localStorageState) {\n      return localStorageState.userMap;\n    }\n\n    return null;\n  };\n\n  if (!menu.menuState.mapName.length > 0) {\n    if (props.location.state) {\n      localStorage.setItem(\"mapVersion\", 0);\n      localStorage.setItem(\"map\", JSON.stringify(props.location.state));\n      menu.dispatch({\n        type: \"edit\"\n      });\n      menu.dispatch({\n        type: \"mapName\",\n        payload: {\n          mapName: props.location.state.mapName\n        }\n      });\n    } else if (localStorage.getItem(\"map\")) {\n      console.log(parseInt(localStorage.getItem(\"mapVersion\")));\n      console.log(JSON.parse(localStorage.getItem(\"map\"))); //Theres another way to do this\n\n      if (memlocalStorageState.localStorageState.mapName !== JSON.parse(localStorage.getItem(\"map\")).mapName && memlocalStorageState.localStorageState.userMap !== JSON.parse(localStorage.getItem(\"map\")).userMap && memlocalStorageState.localStorageState.mapVersion !== JSON.parse(localStorage.getItem(\"mapVersion\")).mapVersion) {\n        setLocalStorageState(localStorageState => {\n          return { ...memlocalStorageState.localStorageState,\n            mapName: JSON.parse(localStorage.getItem(\"map\")).mapName,\n            userMap: JSON.parse(localStorage.getItem(\"map\")).userMap,\n            mapVersion: JSON.parse(localStorage.getItem(\"mapVersion\")).mapVersion\n          };\n        });\n      }\n\n      console.log(memlocalStorageState.localStorageState);\n\n      if (localStorageState.mapVersion !== 0) {\n        getUserMap({\n          variables: {\n            mapName: memlocalStorageState.localStorageState.mapName\n          }\n        });\n      } else {\n        menu.dispatch({\n          type: \"edit\"\n        });\n        menu.dispatch({\n          type: \"mapName\",\n          payload: {\n            mapName: memlocalStorageState.localStorageState.mapName\n          }\n        });\n      }\n    }\n  }\n\n  console.log(menu.menuState.mapName, menu.menuState.mapName[0], menu.menuState.mapName[menuState.mapName.length - 1]);\n  useEffect(() => {\n    const handleWinResize = () => {\n      setWinDimensions({\n        width: document.documentElement.clientWidth,\n        height: document.documentElement.clientHeight\n      });\n    };\n\n    window.addEventListener('resize', handleWinResize); // console.log(\"Window has been resized: \", winDimensions.width, winDimensions.height);\n\n    return () => {\n      window.removeEventListener('resize', handleWinResize);\n    };\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"sandbox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(MenuContext.Provider, {\n    value: menu,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Map, {\n    winDimensions: winDimensions,\n    userMap: getMap(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Menu, {\n    initialState: initialState,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 17\n    }\n  })));\n}\n\nexport default Sandbox;","map":{"version":3,"sources":["/home/menekou/projects/react/shortest-path/react-frontend/src/Sandbox/Sandbox.js"],"names":["React","useState","useEffect","useMemo","useReducer","Map","Menu","MenuContext","useLazyQuery","MapHelper","init","initialState","itemState","clear","run","heuristic","algorithm","pathClear","cutCorners","allowDiags","biDirectional","isResetting","isSaving","mapName","isEdit","reducer","menuState","action","type","payload","Error","Sandbox","props","winDimensions","setWinDimensions","width","document","documentElement","clientWidth","height","clientHeight","dispatch","localStorageState","setLocalStorageState","userMap","mapVersion","menu","memlocalStorageState","getUserMap","error","getUserMapError","loading","getUserMapLoading","data","getUserMapData","fetchPolicy","console","log","name","localStorage","setItem","map","getMap","location","state","length","JSON","stringify","getItem","parseInt","parse","variables","handleWinResize","window","addEventListener","removeEventListener"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo, useReducer } from 'react';\nimport './Sandbox.css';\nimport Map from '../Map/Map';\nimport Menu from '../Menu/Menu';\nimport MenuContext from '../MenuContext';\nimport { useLazyQuery } from '@apollo/client';\nimport MapHelper from '../Helpers/MapHelper';\n\nfunction init(initialState){\n    return {\n        itemState: initialState.itemState,\n        clear: initialState.clear,\n        run: initialState.run,\n        heuristic: initialState.heuristic,\n        algorithm: initialState.algorithm,\n        pathClear: initialState.pathClear,\n        cutCorners: initialState.cutCorners,\n        allowDiags: initialState.allowDiags,\n        biDirectional: initialState.biDirectional,\n        isResetting: initialState.isResetting,\n        isSaving: initialState.isSaving,\n        mapName: initialState.mapName,\n        isEdit: initialState.isEdit,\n    }\n}\n\nfunction reducer(menuState, action){\n    switch (action.type) {\n        case 'setItemState':\n            return {...menuState, itemState: action.payload.itemState}\n        case 'mapName':\n            return {...menuState, mapName: [...menuState.mapName, action.payload.mapName]}\n        case 'mapNameReset':\n            return {...menuState, mapName: []}\n        case 'setHeuristic':\n            return {...menuState, heuristic: action.payload.heuristic}\n        case 'setAlgorithm':\n            return {...menuState, algorithm: action.payload.algorithm}   \n        case 'clear':\n            return {...menuState, clear: true};\n        case 'cleared':\n            return {...menuState, clear: false};\n        case 'pathClear':\n            return {...menuState, pathClear: true};\n        case 'pathCleared':\n            return {...menuState, pathClear: false};\n        case 'run':\n            return {...menuState, run: true};\n        case 'complete':\n            return {...menuState, run: false};\n        case 'cutCorners':\n            return {...menuState, cutCorners: !menuState.cutCorners};\n        case 'allowDiags':\n            return {...menuState, allowDiags: !menuState.allowDiags};\n        case 'biDirectional':\n            return {...menuState, biDirectional: !menuState.biDirectional};\n        case 'reset':\n            return {...menuState, isResetting: !menuState.isResetting};\n        case 'save':\n            return {...menuState, isSaving: !menuState.isSaving};\n        case 'edit':\n            return {...menuState, isEdit: true};\n        case 'initialize':\n            return init(action.payload.init);\n        default:\n            throw new Error(\"Not a valid action\");\n    }\n}\n\nfunction Sandbox(props) {\n    const [winDimensions, setWinDimensions] = useState({ width: document.documentElement.clientWidth, height: document.documentElement.clientHeight });\n\n    const initialState = {\n        itemState: \"start\",\n        heuristic: \"euclidean\",\n        algorithm: \"astar\",\n        clear: false,\n        pathClear: false,\n        run: false,\n        cutCorners: false,\n        allowDiags: true,\n        biDirectional: false,\n        isResetting: false,\n        isSaving: false,\n        mapName: [],\n        isEdit: false,\n    }\n\n    const [menuState, dispatch] = useReducer(reducer, initialState, init);\n    const [localStorageState, setLocalStorageState] = useState({\n        mapName: null,\n        userMap: null,\n        mapVersion: null\n    })\n\n    const menu = useMemo(() => ({menuState, dispatch}), [menuState, dispatch]);\n    const memlocalStorageState = useMemo(() => ({localStorageState, setLocalStorageState}), [localStorageState, setLocalStorageState]);\n\n    const [getUserMap, { error: getUserMapError, loading: getUserMapLoading, data: getUserMapData }] = useLazyQuery(MapHelper.getUserMap, {\n        fetchPolicy: \"network-only\"\n    });\n    \n    useEffect(() => {\n        if(getUserMapError){\n            console.log(getUserMapError);\n        }\n\n        if(getUserMapLoading){\n            console.log(getUserMapLoading);\n            menu.dispatch({type: \"mapName\", payload: { mapName: \"...\" }});\n        }\n\n        if(getUserMapData){\n            console.log(\"data retrieved\")\n            menu.dispatch({type: \"edit\"});\n            menu.dispatch({type: \"mapNameReset\"});\n            menu.dispatch({type: \"mapName\", payload: { mapName: getUserMapData.getUserMap.name }});\n\n            setLocalStorageState((localStorageState) => {\n                localStorage.setItem(\"mapVersion\", 0);\n                \n                return {\n                    ...memlocalStorageState.localStorageState,\n                    mapName: getUserMapData.getUserMap.name,\n                    userMap: getUserMapData.getUserMap.map,\n                    mapVersion: 0\n                }  \n            })\n        }\n    }, [getUserMapError, getUserMapLoading, getUserMapData, menu]);\n\n    const getMap = () => {\n        console.log(getUserMapLoading)\n        if(props.location.state){\n            return props.location.state.userMap;\n        }\n\n        if(localStorageState){\n            return localStorageState .userMap;\n        }\n\n        return null;\n    }\n\n    if(!menu.menuState.mapName.length > 0){\n        if(props.location.state){\n            localStorage.setItem(\"mapVersion\", 0);\n            localStorage.setItem(\"map\", JSON.stringify(props.location.state));\n\n            menu.dispatch({type: \"edit\"});\n            menu.dispatch({type: \"mapName\", payload: { mapName: props.location.state.mapName }});\n        }else if(localStorage.getItem(\"map\")){\n            console.log(parseInt(localStorage.getItem(\"mapVersion\")));\n            console.log(JSON.parse(localStorage.getItem(\"map\")));\n\n            //Theres another way to do this\n            if(memlocalStorageState.localStorageState.mapName !== JSON.parse(localStorage.getItem(\"map\")).mapName \n            && memlocalStorageState.localStorageState.userMap !== JSON.parse(localStorage.getItem(\"map\")).userMap \n            && memlocalStorageState.localStorageState.mapVersion !== JSON.parse(localStorage.getItem(\"mapVersion\")).mapVersion){\n                setLocalStorageState((localStorageState) => {\n                    return {\n                        ...memlocalStorageState.localStorageState,\n                        mapName: JSON.parse(localStorage.getItem(\"map\")).mapName,\n                        userMap: JSON.parse(localStorage.getItem(\"map\")).userMap,\n                        mapVersion: JSON.parse(localStorage.getItem(\"mapVersion\")).mapVersion\n                    }  \n                })\n            }\n            console.log(memlocalStorageState.localStorageState)\n            if(localStorageState.mapVersion !== 0){\n                \n                getUserMap({\n                    variables: {\n                        mapName: memlocalStorageState.localStorageState.mapName\n                    }\n                })\n            }else{\n                menu.dispatch({type: \"edit\"});\n                menu.dispatch({type: \"mapName\", payload: { mapName: memlocalStorageState.localStorageState.mapName }});\n            }\n        }\n    }\n\n    console.log(menu.menuState.mapName, menu.menuState.mapName[0], menu.menuState.mapName[menuState.mapName.length-1])\n\n    useEffect(() => {\n        const handleWinResize = () => {\n            setWinDimensions({\n                width: document.documentElement.clientWidth,\n                height: document.documentElement.clientHeight\n            })\n        }\n\n        window.addEventListener('resize', handleWinResize);\n\n        // console.log(\"Window has been resized: \", winDimensions.width, winDimensions.height);\n\n        return () => {\n            window.removeEventListener('resize', handleWinResize);\n        };\n    })\n\n    return (\n        <div id=\"sandbox\">\n            <MenuContext.Provider value={menu}>\n                <Map \n                    winDimensions={winDimensions}\n                    userMap={getMap()}\n                />\n                <Menu \n                    initialState={initialState}\n                />\n            </MenuContext.Provider>\n        </div>\n    );\n}\n\nexport default Sandbox;"]},"metadata":{},"sourceType":"module"}
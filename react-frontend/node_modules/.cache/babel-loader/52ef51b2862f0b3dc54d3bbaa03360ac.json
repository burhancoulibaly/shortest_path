{"ast":null,"code":"var _jsxFileName = \"/home/menekou/projects/react/shortest-path/react-frontend/src/Account/Account.js\";\nimport React, { useEffect, useContext, useState } from 'react';\nimport './Account.css';\nimport UserContext from \"../UserContext\";\nimport { useQuery } from '@apollo/client';\nimport MapHelper from '../Helpers/MapHelper';\nimport { Link } from 'react-router-dom';\nimport Modal from 'react-bootstrap/Modal';\nimport { useMutation } from '@apollo/client';\n\nfunction EditMapModal({\n  mapName,\n  handleNameEdit,\n  ...props\n}) {\n  return /*#__PURE__*/React.createElement(Modal, Object.assign({}, props, {\n    size: \"lg\",\n    \"aria-labelledby\": \"contained-modal-title-vcenter\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    id: \"contained-modal-title-vcenter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 15\n    }\n  }, \"Set Map Name\")), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    className: \"editmap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"mapname\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 23\n    }\n  }, \"Map Name\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"mapname\",\n    className: \"form-control\",\n    id: \"mapname\",\n    \"aria-describedby\": \"mapNameHelp\",\n    type: \"text\",\n    defaultValue: mapName,\n    placeholder: \"Unamed\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 23\n    }\n  })))), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => handleNameEdit(document.getElementsByClassName(\"editmap\")[0][0].value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 15\n    }\n  }, \"Save Name\")));\n}\n\nfunction EditMapName({\n  map,\n  user,\n  refetch,\n  ...props\n}) {\n  const [modalShow, setModalShow] = React.useState(false);\n  const [editMap, {\n    error: editMapError,\n    loading,\n    data: editMapData\n  }] = useMutation(MapHelper.editMap);\n  useEffect(() => {\n    if (editMapError) {\n      console.log(editMapError);\n    }\n\n    if (editMapData) {\n      console.log(editMapData);\n      refetch();\n    }\n  }, [editMapError, editMapData, refetch]);\n\n  const handleShow = () => {\n    setModalShow(true);\n  };\n\n  const handleClose = () => {\n    setModalShow(false);\n  };\n\n  const handleNameEdit = mapName => {\n    handleClose();\n    console.log(user.username, map.name, mapName, map);\n    editMap({\n      variables: {\n        username: user.username,\n        mapNameOrig: map.name,\n        mapNameEdit: mapName,\n        map: map.map\n      }\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, loading && /*#__PURE__*/React.createElement(\"button\", {\n    disabled: true,\n    onClick: () => handleShow(),\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }, \"Saving...\"), !loading && /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => handleShow(),\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }\n  }, \"Edit Name\"), /*#__PURE__*/React.createElement(EditMapModal, {\n    show: modalShow,\n    handleNameEdit: mapName => handleNameEdit(mapName),\n    mapName: map.name,\n    onHide: () => handleClose(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 11\n    }\n  }));\n}\n\nfunction Account() {\n  const {\n    user\n  } = useContext(UserContext);\n  const {\n    error: mapsError,\n    data: mapsData,\n    refetch: mapsRefetch\n  } = useQuery(MapHelper.getUsersMaps, {\n    variables: {\n      username: user.username\n    }\n  }); //{ fetchPolicy: \"network-only\" }\n\n  const [deleteMap, {\n    error: deleteMapError,\n    loading: deleteMapLoading,\n    data: deleteMapData\n  }] = useMutation(MapHelper.deleteMap);\n  const [maps, setMaps] = useState();\n  useEffect(() => {\n    if (mapsError) {\n      console.log(mapsError);\n    }\n\n    if (mapsData) {\n      console.log(mapsData.getUsersMaps);\n      setMaps(maps => {\n        return mapsData.getUsersMaps;\n      });\n    }\n  }, [user, mapsError, mapsData]);\n  useEffect(() => {\n    if (deleteMapError) {\n      console.log(deleteMapError);\n    }\n\n    if (deleteMapData) {\n      console.log(deleteMapData);\n      mapsRefetch();\n    }\n  }, [user, deleteMapError, deleteMapData, mapsRefetch]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"account\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 5\n    }\n  }, user && /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }\n  }, user.username), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"links-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }\n  }, maps && maps.map((map, index) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"link-container\",\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"map-preview\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }\n    }, \"Map Preview\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"map-info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: {\n        pathname: \"/sandbox\",\n        state: {\n          userMap: map.map,\n          mapName: map.name\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 25\n      }\n    }, map.name)))), user.username === map.owner, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"map-edit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 17\n      }\n    }, user && /*#__PURE__*/React.createElement(EditMapName, {\n      user: user,\n      map: map,\n      refetch: mapsRefetch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Link, {\n      to: {\n        pathname: \"/sandbox\",\n        state: {\n          userMap: map.map,\n          mapName: map.name\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 21\n      }\n    }, \"Edit Map\")), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-danger\",\n      onClick: () => {\n        deleteMap({\n          variables: {\n            username: user.username,\n            mapName: map.name\n          }\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 21\n      }\n    }, \"Delete Map\")));\n  })));\n}\n\nexport default Account;","map":{"version":3,"sources":["/home/menekou/projects/react/shortest-path/react-frontend/src/Account/Account.js"],"names":["React","useEffect","useContext","useState","UserContext","useQuery","MapHelper","Link","Modal","useMutation","EditMapModal","mapName","handleNameEdit","props","document","getElementsByClassName","value","EditMapName","map","user","refetch","modalShow","setModalShow","editMap","error","editMapError","loading","data","editMapData","console","log","handleShow","handleClose","username","name","variables","mapNameOrig","mapNameEdit","Account","mapsError","mapsData","mapsRefetch","getUsersMaps","deleteMap","deleteMapError","deleteMapLoading","deleteMapData","maps","setMaps","index","pathname","state","userMap","owner"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState } from 'react';\nimport './Account.css';\nimport UserContext from \"../UserContext\";\nimport { useQuery } from '@apollo/client';\nimport MapHelper from '../Helpers/MapHelper';\nimport { Link } from 'react-router-dom';\nimport Modal from 'react-bootstrap/Modal';\nimport { useMutation } from '@apollo/client';\n\nfunction EditMapModal({mapName, handleNameEdit, ...props}){\n  return (\n      <Modal\n          {...props}\n          size=\"lg\"\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n      >\n          <Modal.Header closeButton>\n              <Modal.Title id=\"contained-modal-title-vcenter\">\n                  Set Map Name\n              </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n              <form className=\"editmap\">\n                  <div className=\"form-group\">\n                      <label htmlFor=\"mapname\">Map Name</label>\n                      <input type=\"mapname\" className=\"form-control\" id=\"mapname\" aria-describedby=\"mapNameHelp\" type=\"text\" defaultValue={ mapName } placeholder=\"Unamed\"/>\n                  </div>\n              </form>\n          </Modal.Body>\n          <Modal.Footer>\n              <button onClick={() => handleNameEdit(document.getElementsByClassName(\"editmap\")[0][0].value)}>Save Name</button>\n          </Modal.Footer>\n      </Modal>\n  );\n}\n\nfunction  EditMapName({map, user, refetch, ...props}){\n  const [modalShow, setModalShow] = React.useState(false);\n  const [editMap, { error: editMapError, loading, data: editMapData }] = useMutation(MapHelper.editMap);\n   \n  useEffect(() => {\n    if(editMapError){\n      console.log(editMapError);\n    }\n    \n    if(editMapData){\n      console.log(editMapData);\n      refetch();\n    }\n  }, [editMapError, editMapData, refetch])\n\n  const handleShow = () => {\n      setModalShow(true);\n  }\n\n  const handleClose = () => {\n      setModalShow(false);\n  }\n\n  const handleNameEdit = (mapName) => {\n    handleClose();\n    \n    console.log(user.username, map.name, mapName, map)\n    editMap({\n      variables: {\n        username: user.username,\n        mapNameOrig: map.name,\n        mapNameEdit: mapName,\n        map: map.map\n      }\n    })\n  }\n\n  return (\n      <>\n          { loading &&\n            <button disabled={true} onClick={() => handleShow()} className=\"btn btn-primary\">Saving...</button>\n          }\n\n          { !loading &&\n            <button onClick={() => handleShow()} className=\"btn btn-primary\">Edit Name</button>\n          }        \n\n          <EditMapModal\n              show={modalShow}\n              handleNameEdit={(mapName) => handleNameEdit(mapName)}\n              mapName={map.name}\n              onHide={() => handleClose()}\n          />\n      </>\n  );\n}\n\nfunction Account() {\n  const {user} = useContext(UserContext);\n  const { error: mapsError, data: mapsData, refetch: mapsRefetch} = useQuery(MapHelper.getUsersMaps, {\n    variables: {\n      username: user.username\n    }\n  }); //{ fetchPolicy: \"network-only\" }\n  const [deleteMap, { error: deleteMapError, loading: deleteMapLoading, data: deleteMapData }] = useMutation(MapHelper.deleteMap);\n\n  const [maps, setMaps] = useState(); \n\n  useEffect(() => {\n    if(mapsError){\n      console.log(mapsError);\n    }\n\n    if(mapsData){\n      console.log(mapsData.getUsersMaps);\n\n      setMaps((maps) => {\n        return mapsData.getUsersMaps;\n      })\n    }\n  }, [user, mapsError, mapsData]);\n\n  useEffect(() => {\n    if(deleteMapError){\n      console.log(deleteMapError);\n    }\n\n    if(deleteMapData){\n      console.log(deleteMapData);\n\n      mapsRefetch();\n    }\n  }, [user, deleteMapError, deleteMapData, mapsRefetch]);\n\n  return (\n    <div id=\"account\">\n      {user &&\n        <h1>{user.username}</h1>\n      }\n      <div className=\"links-container\">\n      {maps && \n        maps.map((map, index) => {\n          return (\n              <div className=\"link-container\" key={index}>\n                <div className=\"map-preview\">\n                  Map Preview\n                </div>\n                <div className=\"map-info\">\n                  <Link to={{pathname: \"/sandbox\", state: { userMap: map.map, mapName: map.name }}}>\n                    <div>\n                        <h3>{map.name}</h3>\n                    </div>\n                  </Link>\n                </div>\n                { user.username === map.owner\n\n                }\n                <div className=\"map-edit\">\n                  { user &&\n                    <EditMapName \n                      user={user}\n                      map={map}\n                      refetch={mapsRefetch}\n                    />\n                  }\n                  <Link to={{pathname: \"/sandbox\", state: { userMap: map.map, mapName: map.name }}}>\n                    <button className=\"btn btn-primary\">\n                      Edit Map\n                    </button>\n                  </Link>\n\n                    <button className=\"btn btn-danger\" onClick={() => {\n                      deleteMap({\n                        variables: {\n                          username: user.username,\n                          mapName: map.name\n                        }\n                      })\n                    }}>Delete Map</button>\n\n\n                  {/* {deleteMapLoading &&\n                    <button disabled={true} className=\"btn btn-danger\">Deleting Map...</button>\n                  } */}\n                </div>\n              </div>            \n            )\n          })\n        }\n      </div>\n    </div>\n  );\n}\n\nexport default Account;"]},"metadata":{},"sourceType":"module"}
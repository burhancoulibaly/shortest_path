{"ast":null,"code":"var _jsxFileName = \"/home/menekou/projects/react/shortest-path/react-frontend/src/Account/Account.js\";\nimport React, { useEffect, useContext, useState } from 'react';\nimport './Account.css';\nimport UserContext from \"../UserContext\";\nimport { useQuery } from '@apollo/client';\nimport MapHelper from '../Helpers/MapHelper';\nimport InputValidationHelper from '../Helpers/InputValidationHelper';\nimport { Link } from 'react-router-dom';\nimport Modal from 'react-bootstrap/Modal';\nimport { useMutation } from '@apollo/client';\n\nfunction EditMapModal({\n  mapName,\n  handleNameEdit,\n  ...props\n}) {\n  const [inputState, setInputState] = useState({\n    isMapNameInvalid: false,\n    mapNameErrorMessage: \"\"\n  });\n\n  const handleChange = e => {\n    setInputState({ ...inputState,\n      isMapNameInvalid: InputValidationHelper.validateString(e.target.value),\n      mapNameErrorMessage: InputValidationHelper.validateString(e.target.value) === false ? \"Invalid map name\" : \"\"\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Modal, Object.assign({}, props, {\n    size: \"lg\",\n    \"aria-labelledby\": \"contained-modal-title-vcenter\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    id: \"contained-modal-title-vcenter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 15\n    }\n  }, \"Set Map Name\")), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    className: \"editmap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"mapname\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 23\n    }\n  }, \"Map Name\"), mapNameInvalid && errorMessage, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: e => handleChange(e),\n    className: (state.isMapNameInvalid ? \"error\" : \"\") + \"form-control\",\n    id: \"mapname\",\n    \"aria-describedby\": \"mapNameHelp\",\n    type: \"text\",\n    defaultValue: mapName,\n    placeholder: \"Unamed\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 23\n    }\n  })))), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    disabled: state.isMapNameInvalid,\n    onClick: () => handleNameEdit(document.getElementsByClassName(\"editmap\")[0][0].value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 15\n    }\n  }, \"Save Name\")));\n}\n\nfunction EditMapName({\n  map,\n  user,\n  refetch,\n  ...props\n}) {\n  const [modalShow, setModalShow] = React.useState(false);\n  const [editMap, {\n    error: editMapError,\n    loading,\n    data: editMapData\n  }] = useMutation(MapHelper.editMap);\n  useEffect(() => {\n    if (editMapError) {\n      console.log(editMapError);\n    }\n\n    if (editMapData) {\n      console.log(editMapData);\n      refetch();\n    }\n  }, [editMapError, editMapData, refetch]);\n\n  const handleShow = () => {\n    setModalShow(true);\n  };\n\n  const handleClose = () => {\n    setModalShow(false);\n  };\n\n  const handleNameEdit = mapName => {\n    handleClose();\n    console.log(user.username, map.name, mapName, map);\n    editMap({\n      variables: {\n        username: user.username,\n        mapNameOrig: map.name,\n        mapNameEdit: mapName,\n        map: map.map\n      }\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, loading && /*#__PURE__*/React.createElement(\"button\", {\n    disabled: true,\n    onClick: () => handleShow(),\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }\n  }, \"Saving...\"), !loading && /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => handleShow(),\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }, \"Edit Name\"), /*#__PURE__*/React.createElement(EditMapModal, {\n    show: modalShow,\n    handleNameEdit: mapName => handleNameEdit(mapName),\n    mapName: map.name,\n    onHide: () => handleClose(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 11\n    }\n  }));\n}\n\nfunction Account() {\n  const {\n    user\n  } = useContext(UserContext);\n  const {\n    error: mapsError,\n    data: mapsData,\n    refetch\n  } = useQuery(MapHelper.getUsersMaps, {\n    variables: {\n      username: user.username\n    },\n    notifyOnNetworkStatusChange: true\n  }); //{ fetchPolicy: \"network-only\" }\n\n  const [deleteMap, {\n    error: deleteMapError,\n    loading: deleteMapLoading,\n    data: deleteMapData\n  }] = useMutation(MapHelper.deleteMap);\n  const [maps, setMaps] = useState();\n  useEffect(() => {\n    if (mapsError) {\n      console.log(mapsError);\n    }\n\n    if (mapsData) {\n      console.log(mapsData.getUsersMaps);\n      setMaps(maps => {\n        return mapsData.getUsersMaps;\n      });\n    }\n  }, [user, mapsError, mapsData]);\n  useEffect(() => {\n    if (deleteMapError) {\n      console.log(deleteMapError);\n    }\n\n    if (deleteMapData) {\n      console.log(deleteMapData);\n      refetch();\n    }\n  }, [deleteMapError, deleteMapData, refetch]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"account\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 5\n    }\n  }, user && /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 9\n    }\n  }, user.username), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"links-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }\n  }, maps && maps.map((map, index) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"link-container\",\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"map-info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: {\n        pathname: \"/sandbox\",\n        state: {\n          userMap: map.map,\n          mapName: map.name\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 25\n      }\n    }, map.name)))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"top-users\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 19\n      }\n    }, \"Top 3 Users\"), /*#__PURE__*/React.createElement(\"ol\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 19\n      }\n    }, map.highest_score && /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 23\n      }\n    }, map.highest_score), map.second_highest_score && /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 23\n      }\n    }, map.second_highest_score), map.third_highest_score && /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 23\n      }\n    }, map.third_highest_score))), user.username === map.owner && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"map-edit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 19\n      }\n    }, user && /*#__PURE__*/React.createElement(EditMapName, {\n      user: user,\n      map: map,\n      refetch: refetch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(Link, {\n      to: {\n        pathname: \"/sandbox\",\n        state: {\n          userMap: map.map,\n          mapName: map.name\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 23\n      }\n    }, \"Edit Map\")), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-danger\",\n      onClick: () => {\n        deleteMap({\n          variables: {\n            username: user.username,\n            mapName: map.name\n          }\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 23\n      }\n    }, \"Delete Map\")));\n  })));\n}\n\nexport default Account;","map":{"version":3,"sources":["/home/menekou/projects/react/shortest-path/react-frontend/src/Account/Account.js"],"names":["React","useEffect","useContext","useState","UserContext","useQuery","MapHelper","InputValidationHelper","Link","Modal","useMutation","EditMapModal","mapName","handleNameEdit","props","inputState","setInputState","isMapNameInvalid","mapNameErrorMessage","handleChange","e","validateString","target","value","mapNameInvalid","errorMessage","state","document","getElementsByClassName","EditMapName","map","user","refetch","modalShow","setModalShow","editMap","error","editMapError","loading","data","editMapData","console","log","handleShow","handleClose","username","name","variables","mapNameOrig","mapNameEdit","Account","mapsError","mapsData","getUsersMaps","notifyOnNetworkStatusChange","deleteMap","deleteMapError","deleteMapLoading","deleteMapData","maps","setMaps","index","pathname","userMap","highest_score","second_highest_score","third_highest_score","owner"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState } from 'react';\nimport './Account.css';\nimport UserContext from \"../UserContext\";\nimport { useQuery } from '@apollo/client';\nimport MapHelper from '../Helpers/MapHelper';\nimport InputValidationHelper from '../Helpers/InputValidationHelper';\nimport { Link } from 'react-router-dom';\nimport Modal from 'react-bootstrap/Modal';\nimport { useMutation } from '@apollo/client';\n\nfunction EditMapModal({mapName, handleNameEdit, ...props}){\n  const [inputState, setInputState] = useState({\n    isMapNameInvalid: false,\n    mapNameErrorMessage: \"\",\n  })\n\n  const handleChange = (e) => {\n    setInputState({\n      ...inputState,\n      isMapNameInvalid: InputValidationHelper.validateString(e.target.value),\n      mapNameErrorMessage: InputValidationHelper.validateString(e.target.value) === false ? \"Invalid map name\" : \"\"\n    })\n  }\n\n  return (\n      <Modal\n          {...props}\n          size=\"lg\"\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n      >\n          <Modal.Header closeButton>\n              <Modal.Title id=\"contained-modal-title-vcenter\">\n                  Set Map Name\n              </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n              <form className=\"editmap\">\n                  <div className=\"form-group\">\n                      <label htmlFor=\"mapname\">Map Name</label>\n                      {mapNameInvalid &&\n                        errorMessage\n                      }\n                      <input onChange={(e) => handleChange(e)} className={(state.isMapNameInvalid ? \"error\" : \"\") + \"form-control\"} id=\"mapname\" aria-describedby=\"mapNameHelp\" type=\"text\" defaultValue={ mapName } placeholder=\"Unamed\"/>\n                  </div>\n              </form>\n          </Modal.Body>\n          <Modal.Footer>\n              <button disabled={state.isMapNameInvalid} onClick={() => handleNameEdit(document.getElementsByClassName(\"editmap\")[0][0].value)}>Save Name</button>\n          </Modal.Footer>\n      </Modal>\n  );\n}\n\nfunction  EditMapName({map, user, refetch, ...props}){\n  const [modalShow, setModalShow] = React.useState(false);\n  const [editMap, { error: editMapError, loading, data: editMapData }] = useMutation(MapHelper.editMap);\n   \n  useEffect(() => {\n    if(editMapError){\n      console.log(editMapError);\n    }\n    \n    if(editMapData){\n      console.log(editMapData);\n      refetch();\n    }\n  }, [editMapError, editMapData, refetch])\n\n  const handleShow = () => {\n      setModalShow(true);\n  }\n\n  const handleClose = () => {\n      setModalShow(false);\n  }\n\n  const handleNameEdit = (mapName) => {\n    handleClose();\n    \n    console.log(user.username, map.name, mapName, map)\n    editMap({\n      variables: {\n        username: user.username,\n        mapNameOrig: map.name,\n        mapNameEdit: mapName,\n        map: map.map\n      }\n    })\n  }\n\n  return (\n      <>\n          { loading &&\n            <button disabled={true} onClick={() => handleShow()} className=\"btn btn-primary\">Saving...</button>\n          }\n\n          { !loading &&\n            <button onClick={() => handleShow()} className=\"btn btn-primary\">Edit Name</button>\n          }        \n\n          <EditMapModal\n              show={modalShow}\n              handleNameEdit={(mapName) => handleNameEdit(mapName)}\n              mapName={map.name}\n              onHide={() => handleClose()}\n          />\n      </>\n  );\n}\n\nfunction Account() {\n  const {user} = useContext(UserContext);\n  const { error: mapsError, data: mapsData, refetch} = useQuery(MapHelper.getUsersMaps, {\n    variables: {\n      username: user.username\n    },\n    notifyOnNetworkStatusChange: true,\n  }); //{ fetchPolicy: \"network-only\" }\n  const [deleteMap, { error: deleteMapError, loading: deleteMapLoading, data: deleteMapData }] = useMutation(MapHelper.deleteMap);\n\n  const [maps, setMaps] = useState(); \n\n  useEffect(() => {\n    if(mapsError){\n      console.log(mapsError);\n    }\n\n    if(mapsData){\n      console.log(mapsData.getUsersMaps);\n\n      setMaps((maps) => {\n        return mapsData.getUsersMaps;\n      })\n    }\n  }, [user, mapsError, mapsData]);\n\n  useEffect(() => {\n    if(deleteMapError){\n      console.log(deleteMapError);\n    }\n\n    if(deleteMapData){\n      console.log(deleteMapData);\n\n\n      refetch();\n    }\n  }, [deleteMapError, deleteMapData, refetch]);\n\n  return (\n    <div id=\"account\">\n      {user &&\n        <h1 className=\"username\">{user.username}</h1>\n      }\n      <div className=\"links-container\">\n      {maps && \n        maps.map((map, index) => {\n          return (\n              <div className=\"link-container\" key={index}>\n                {/* <div className=\"map-preview\">\n                  Map Preview\n                </div> */}\n                <div className=\"map-info\">\n                  <Link to={{pathname: \"/sandbox\", state: { userMap: map.map, mapName: map.name }}}>\n                    <div>\n                        <h3>{map.name}</h3>\n                    </div>\n                  </Link>\n                </div>\n                <div className=\"top-users\">\n                  <div className=\"title\">\n                    Top 3 Users\n                  </div>\n                  <ol>\n                    {map.highest_score &&\n                      <li>\n                        {map.highest_score}\n                      </li>\n                    }\n                    {map.second_highest_score &&\n                      <li>\n                        {map.second_highest_score}\n                      </li>\n                    }\n                    {map.third_highest_score &&\n                      <li>\n                        {map.third_highest_score}\n                      </li>\n                    }\n                  </ol>\n                </div>\n                { user.username === map.owner &&\n                  <div className=\"map-edit\">\n                    { user &&\n                      <EditMapName \n                        user={user}\n                        map={map}\n                        refetch={refetch}\n                      />\n                    }\n                    <Link to={{pathname: \"/sandbox\", state: { userMap: map.map, mapName: map.name }}}>\n                      <button className=\"btn btn-primary\">\n                        Edit Map\n                      </button>\n                    </Link>\n\n                      <button className=\"btn btn-danger\" onClick={() => {\n                        deleteMap({\n                          variables: {\n                            username: user.username,\n                            mapName: map.name\n                          }\n                        })\n                      }}>Delete Map</button>\n\n\n                    {/* {deleteMapLoading &&\n                      <button disabled={true} className=\"btn btn-danger\">Deleting Map...</button>\n                    } */}\n                  </div>\n                }\n              </div>            \n            )\n          })\n        }\n      </div>\n    </div>\n  );\n}\n\nexport default Account;"]},"metadata":{},"sourceType":"module"}